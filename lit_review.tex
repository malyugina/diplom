\chapter{Обзор литературы}

\section{Вариабельность сердечного ритма }

Вариабельность сердечного ритма (Heart rate variability) это явление изменения частоты сердечного ритма.

Вариабельность сердечного ритма очень сильно зависит от эмоционального \cite{hrv_and_sensitivity, hrv_and_respiratory} и физического \cite{hrv_and_phisical_health} здоровья человека и может использоваться как его показатель.

Существуют два основных частоты колебания сердечного ритма \cite{two_rates_hrv}.

\begin{itemize}
	\item Колебания, вызванные дыхательной аритмией. При этом частота сердечных сокращений изменяется в связи с дыханием и можно отследить частоту дыхания.
	\item Низкочастотные колебания артериального давления. Это явление называется волнами Майера \cite{mayer_wave} артериального давления и, как правило, имеют частоты порядка 0,1 Гц.
\end{itemize}

Для наблюдения за сердечным ритмом применяются следующие методы:

\begin{itemize}
	\item ЭКГ (электрокардиография) \cite{EKG};
	\item баллистокардиография  \cite{Ballistocardiograms};
	\item фотоплетизмография \cite{Photoplethysmography}.
\end{itemize}

ЭКГ считается методом, дающим наиболее четкий сигнал.

\subsection{ЭКГ}

Электрокардиограмма – это запись колебаний разности потенциалов, возникающих на поверхности возбудимой ткани или в окружающей сердце проводящей среде при распространении волны возбуждения по сердцу.\cite{ekg1} Запись ЭКГ производится с помощью электрокардиографов и различных систем отведений ЭКГ. Каждое отведение регистрирует разность потенциалов, существующую между двумя определенными точками электрического поля сердца, в которых установлены электроды. Пример ЭКГ можно увидеть на рис. \ref{ris:RR}.

\begin{figure}[h]
	\begin{center}
		\includegraphics[scale=0.36]{RR.png}
		\caption{ЭКГ}
		\label{ris:RR}
	\end{center}
\end{figure}

Сердце обладает рядом свойств.

\begin{itemize}
	\item Свойство автоматизма - это способность сердца вырабатывать электрические импульсы при отсутствии внешних раздражений.
	\item Свойство проводимости - это способность к проведению возбуждения волокон проводящей системы сердца и сократительного миокарда.
	\item Свойство возбудимости – это способность клеток проводящей системы сердца и сократительного миокарда возбуждаться под влиянием внешних электрических импульсов.
\end{itemize}

Возбуждение сердечной мышцы сопровождается возникновением изменяющейся разности потенциалов между наружной и внутренней поверхностью клеточной мембраны сердца.

При распространении по сердцу волны деполяризации наружная поверхность клетки приобретает отрицательный заряд, а во время реполяризации – положительный. Согласно концепции В. Эйнтховена, сердце в каждый момент сердечного цикла можно рассматривать как точечный единый диполь, который создает в окружающей его среде электрическое поле. Положительный полюс диполя (+) всегда обращен в сторону невозбужденного, а отрицательный полюс (–) – в сторону возбужденного участка сердца. \ref{ris:dipol} 

\begin{figure}[h]
	\begin{center}
		\includegraphics[scale=0.36]{heart-dipol}
		\caption{Поле сордечного диполя в отведениях}
		\label{ris:dipol}
	\end{center}
\end{figure}


Помещая положительный и отрицательный электроды в любые точки электрического поля, можно зарегистрировать разность потенциалов, существующую между этими точками в каждый момент деполяризации и реполяризации сердца. Конфигурация такой ЭКГ прежде всего будет зависеть от направления вектора диполя по отношению к электродам.

В настоящее время в клинической практике наиболее широко используют 12 от ведений ЭКГ, запись которых является обязательной при каждом электрокардиографическом обследовании больного: 3 стандартных отведения, 3 усиленных однополюсных отведения от конечностей и 6 грудных отведений.

Стандартные отведения от конечностей регистрируют при следующем попарном подключении электродов:
I отведение – левая рука (+) и правая рука (–);
II отведение – левая нога (+) и правая рука (–);
III отведение – левая нога (+) и левая рука (–);

\subsection{RR}
RR-интервалом называется промежуток времени между последовательными ударами сердца. Нормально частотой серцебиения считается 60-100 ударов в минуту в состоянии покоя. Если рассматривать момент сокращения сердца более подробно \cite{polarization_heart} виден QRS-комплекс - изменения электрического потенциала, предшествующее сокращению сердца. За электрической активацией клеток (деполяризацией) следует механическое сокращение, создаваемое следующим образом. Процесс сокращения сердечных мыщц состоит из следующих стадий.

\begin{itemize}
	\item деполяризация предсердий; зубец P
	\item передача импульса желудочкам; интервал PR
	\item деполяризация желудочков; зубец R
	\item реполярицазия желудочков; зубец T
	\item мнения исследователей относительно причин происхождения зубца V различны
\end{itemize}

По длительности интервалов, глубине минимумов и высоте максимумов врачи предсказывают различные характеристики и болезни.


\subsection{анализ HRV}

Основные методы исследования HRV.

\begin{enumerate}
	\item Методы основанные на анализе интервалов между сердечными ударами NN типа. При данном анализе часто подсчитываются следующие характеристики \cite{pNN, metric_of_hrv}.
	\begin{enumerate}
		\item SDNN, стандартное отклонение интервалов NN от среднего, вычесленого почти всегда в течение 24 часов. SDNN обычно вычисляется для коротких интервалов, порядка 5 минут. SDNN отражает все циклические компоненты, ответственные за изменчивость в период записи, поэтому она представляет собой общую вариабельность.
		\item 	RMSSD ("среднеквадратичное последовательных различий»), квадратный корень из среднего значения квадратов последовательных разностей между соседними NN ударами.
		\item SDSD ("стандартное отклонение последовательных разностей"), стандартное отклонение последовательных разностей между соседними NNS.
		\item NN50, количество пар последовательных NN ударов, которые отличаются более чем 50 мс.
		\item pNN50, доля NN50 делится на общее количество NN ударов.
		\item 	NN20, количество пар последовательных NN ударов, которые отличаются более чем 20 мс.
		\item pNN20, доля NN20.
		\item EBS ("оценивается цикл дыхания"), диапазон (макс-мин) в скользящем окне заданной длительности. Окна можно перемещать без перекрытия или с перекрытием. ЕВС часто используют при сборе данных, где обратная связь ВСР в режиме реального времени является главной целью.
	\end{enumerate}
	\item Геометрические методы \cite{geometric_metric}
	\item Частотный анализ
	
	Строятся гистограммы частотных характеристик NN ударов
	
	\item Подсчет кореляций следующих NN ударов от предидущих \cite{autocorr_metric}
	\item Нелинейные методы \cite{non_linear_metric}
	
	\begin{enumerate}
		\item график Пуанкаре \cite{poinkare_plot}.
		\item фрактальные размерности \cite{fractal_dim}.
		\item флуктуационный анализ \cite{fluct_analis}
		\item энтропия \cite{entropy1, entropy2, entropy3}
		\item и др. \cite{other_analis1, other_analis2, other_analis3}
	\end{enumerate}	
\end{enumerate}

\section{Предсказание сна}

Сон-это естественная часть жизни каждого человека. Он происходит каждые 24 часа и занимает почти треть нашей жизни. Он состоит из последовательной смены фаз; это преемственность очень показателеное качества сна который позволяет выделить определенные патологии. Например: апноэ у пациентов с остановкой дыхания в течение ночи, и нарколептический пациентам получить доступ к сонливости в дневное время [1]. Поэтому хороший анализ сна был представлен
классификация ночных этапов. По этой причине
Полисомнография (ПСГ) была сделана; что является отсылкой
тест для количественного определения и квалификации нарушений сна. ПСЖ
представлены записи нескольких физиологических
переменные во время ночного сна, для того чтобы классифицировать
разные фазы сна. Действительно, эти переменные присутствуют
различные характеристики в зависимости от стадии
рассмотрела сна [1]. Существуют многочисленные обыски для классификации
этапы сна, чтобы уменьшить время анализа, и
повысить достоверность результатов диагностики. Большинство
эти поиски основаны лишь на электроэнцефалограмме
(ЭЭГ) [2, 3, 4]. С другой стороны, они существуют поисков
основываясь на электро-миограмма (ЭМГ) и электроокулограммы
(ЭОГ) [5]. В ПСЖ и другие факторы
вмешаться, чтобы классифицировать различные фазы сна, которые являются:
дыхание, поток воздуха, поступающего через нос и
рот, сатурация кислорода в гемоглобине, электрокардиограммы
(ЭКГ) и усилием грудных и
мышцы живота.
Запись ЭКГ является одним из самых простых и эффективных
технологий в сне обнаружения нарушений. Это регулируется
автономной нервной системы; этот общий источник
причиной корреляции с дыханием [6] и может быть источником
корреляции с разных стадий сна [7, 8, 9].
Различные исследования подтвердили, что несколько новых методов
может распознать апноэ сна и стадий сна от
вариабельность сердечного ритма (ВСР), так как во время сна ВСР
представлена характеристика колебаний, связанных с сна
этапах [10]. Наряду с этим, некоторые исследователи в
в литературе было предложено много подходов для стадий сна
забил. В работе [11] предложен кардио respiratorybased
постановка сна, где они используются ЭКГ, оценивается
частота дыхания и дыхательный сигналов.
Ссылка [12] приводится сравнение между ВРС
спектральный анализ и детрентного флуктуационного анализа (ДФА)
применяется для сна ЭКГ. Многие другие произведения представили новый
метод для изменения точки обнаружения временных рядов называется
прогрессивный детрентного флуктуационного анализа (PDFA). Это
метод, вдохновленный ДКА, используется для выявления изменений в
минимум раз в диапазоне [13]. Недавно, [10] представляют систему, которая
автоматически распознает звонок, рем и медленного в течение
время сна, основываясь только на колебаниях сердечного ритма и [13]
предложен способ сна и бодрствования этапы скоринга и спать
оценка эффективности, используя только один-ЭКГ. Это
метод основан на экстракции, по три
методы; вариабельность сердечного ритма (ВСР), в бестрендовый
флуктуационного анализа (dfa) и windowed ДКА (WDFA).
Целью данного исследования является оценка эффективности
\section{Рекуррентные нейронные сети}
Рекуррентная нейронная сеть – один из типов нейронных сетей \cite{neural_network}, в котором присутствует обратная связь. Другими словами в выход более позднего слоя сети поступает на вход более слоя, считающегося ранее.

Рекуррентные нейронные сети имеют ряд преимуществ перед обычными.
\begin{itemize}
	\item Разнообразные виды входных данных
	\item Способность строить неявные модели данных
	\item Устойчивость к выбросам
	\item 
\end{itemize}

Рекуррентные сети применяются в таких задачах как:
\begin{itemize}
	\item распознавание устной и письменной речи \cite{rnn_for_speech_recognition, rnn_for_text_recognition};
	\item машинный перевод \cite{rnn_for_translation};
	\item предсказания временных рядов \cite{rnn_for_prediction};
	\item И т.п.
\end{itemize}



Основной проблемой при использовании рекуррентных нейронных сетей является проблема исчезающего градиента (vanishing gradient problem \cite{vanishing_gradient_problem}). Если честно подсчитывать градиент на каждой итерации обучения он будет выражаться через произведение градиентов, подсчитанных на всех предыдущих итерация. Если градиенты были малы – наш градиент будет просто не заметен и обучение встанет надолго. 

Проблема исчезающего градиента была подробно рассмотрена Хочрайтером???(произношение) and Шмидхубера, которые разработали LTSM архитектуру \cite{create_lstm}, которая устойчива к данной проблеме. Данная архитектура оказалась проста в использовании и стала стандартным средством борьбы с исчезающим градиентом. Также были осуществлены попытки других способов решения данной проблемы:
\begin{itemize}
	\item обратное распостранение во времени (Backpropagation through time) \cite{Backpropagation}. Используется для обучения сетей Элмана.
	\item использование мощного secondorder алгоритмы оптимизации (Martens, 2010; Мартенс Sutskever, 2011)
	\item регуляризация весов в RNN, что гарантирует, что градиент не обращается в нуль (Pascanu др.,2012)
	\item отказ от всего обучения текущие веса (Jaeger, Haas, 2004; Jaeger, 2001), и очень
	осторожны инициализации параметров РНН (в Sutskever др.,2013).
\end{itemize}
	
Также была обнаружена проблема сильного возрастание градиента, но она легко решилась ограничение на модуль градиента.

\subsection{LSTM}

Данный слой успешно борется с проблеммай исчезающего градиента. Каждый нейрон в данном слое представняет собой "ячейку памяти" (рис. \ref{ris:ltsm}). Данные ячейки организованны для хранения информации и позволяют более качествеено обрабатывать длинные входные последовательности.

\begin{figure}[h]
\begin{center}
	\includegraphics[scale=0.36]{ltsm.png}
	\caption{LSTM ячейка}
	\label{ris:ltsm}
\end{center}
\end{figure}


Пускай на вход LSTM ячейке памяти подается часть входной последовательности $x_t = (x_1, ..., x_N)$ и предыдущие выходной вектор признаков $h_{t-1} = (h_1, ..., h_M)$. Ячейка должна подсчитать вектор признаков $h_t$. Ячейка организованны следующим обрахом:


\begin{equation}
	i_i = \sigma(W_{xi}*x_t+W_{hi}*h_{t-1}+W_{ci}*c_{t-1}+b_i)
\end{equation}
\begin{equation}
	f_t = \sigma(W_{xf}*x_t+W_{hf}*h_{t-1}+W_{cf}*c_{t-1}+b_f)
\end{equation}
\begin{equation}
	c_t = f_t*c_{t-1}+i_t*\tanh(W_{xc}*x_{t-1}+W_{hc}*h_{t-1}+b_c)
\end{equation}
\begin{equation}
	o_t = \sigma(W_{xo}*x_t+W_{ho}*h_{t-1}+W_{co}*c_t+b_o)
\end{equation}
\begin{equation}
	h_t = o_t*\tanh(c_t)
\end{equation}

Здесь $\sigma = \frac{1}{1+e^{-x}} $ - сигмоида, логистическая функция, принимающая значения от 0 до 1. А i, f, o и c - вход ячейки, клетка памяти, выход ячейки и клетка активации, по содержимому которой решается, будет ли использоваться ектор из клетки памяти. Все вышеперечисленные вектора имеют размерность $h_t$.

\subsection{Разнонаправленные рекурентные сети}